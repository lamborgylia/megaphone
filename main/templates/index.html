{% extends "base.html" %}

{% block title %}–ú–µ–≥–∞–§–æ–Ω{% endblock %}

{% block content %}


    <!-- –ö–ê–†–£–°–ï–õ–¨ Bootstrap -->
    <div id="megafonCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
    
        <!-- –°–ª–∞–π–¥ 1 -->
        <div class="carousel-item active">
            <div class="carousel-content">
            <div class="left">
                <h2>–ê–∫—Ç–∏–≤–∏—Ä—É–π –ú–µ–≥–∞–°–∏–ª—ã</h2>
                <p>–ë–µ–∑–ª–∏–º–∏—Ç—ã, –±–æ–Ω—É—Å–Ω—ã–µ –ì–ë –∏ –¥—Ä—É–≥–∏–µ –æ–ø—Ü–∏–∏</p>
                <a href="#" class="btn-custom">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
            </div>
            <div class="right">
                <img src="../static/img/Frame 1.png" class="floating-img" alt="–ê–∫—Ç–∏–≤–∏—Ä—É–π –ú–µ–≥–∞–°–∏–ª—ã" />
            </div>
            </div>
        </div>
    
        <!-- –°–ª–∞–π–¥ 2 -->
        <div class="carousel-item">
            <div class="carousel-content">
            <div class="left">
                <h2>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –¥–æ–º–∞</h2>
                <p>–°—Ç–∞–±–∏–ª—å–Ω—ã–π, –±—ã—Å—Ç—Ä—ã–π, –¥–æ—Å—Ç—É–ø–Ω—ã–π ‚Äî –ø–æ–¥–∫–ª—é—á–∞–π –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å</p>
                <a href="#" class="btn-custom">–í—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–∏—Ñ</a>
            </div>
            <div class="right">
                <img src="../static/img/forhome.png" class="floating-img" alt="–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –¥–æ–º–∞" />
            </div>
            </div>
        </div>
    
        <!-- –°–ª–∞–π–¥ 3 -->
        <div class="carousel-item">
            <div class="carousel-content">
            <div class="left">
                <h2>–ú–æ–±–∏–ª—å–Ω—ã–π<br>–æ–ø–µ—Ä–∞—Ç–æ—Ä ‚Ññ1</h2>
                <p>–ü–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –ø–æ–∫—Ä—ã—Ç–∏—é</p>
                <a href="#" class="btn-custom">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
            </div>
            <div class="right">
                <img src="../static/img/banner3.png" class="floating-img" alt="–ú–æ–±–∏–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä ‚Ññ1" />
            </div>
            </div>
        </div>
    
        </div> 
    
        <!-- –ö–Ω–æ–ø–∫–∏-–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ -->
        <div class="carousel-indicators">
        <button type="button" data-bs-target="#megafonCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#megafonCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#megafonCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>
    </div>

    <!-- –¢–ê–†–ò–§–´ -->
    <section class="tariff-section py-5">
      <div class="container">
        <div class="tariff-header d-flex flex-wrap align-items-center mb-4">
          <h2 class="tariff-title">
            –¢–∞—Ä–∏—Ñ—ã –¥–ª—è —Ç–≤–æ–µ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞: <span id="cityTariff">–≥ –°–∞–º–∞—Ä–∞</span>
          </h2>
        </div>
        
        <div class="tariff-filters d-flex flex-wrap gap-3 mb-4">
          <button class="filter-btn active" data-filter="all">–í—Å–µ —Ç–∞—Ä–∏—Ñ—ã</button>
          <button class="filter-btn" data-filter="internet-mobile-tv">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç, –º–æ–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å + –¢–í</button>
          <button class="filter-btn" data-filter="internet-tv">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç + –¢–í</button>
        </div>

        <div class="tariff-carousel-container">
          <div class="tariff-carousel" id="tariffCardsContainer">
          <!-- Tariff cards will be dynamically loaded here -->
          <div class="col-12 text-center py-4">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
          </div>
          <button class="carousel-control prev" id="prevTariff">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 18l-6-6 6-6"/>
            </svg>
          </button>
          <button class="carousel-control next" id="nextTariff">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 18l6-6-6-6"/>
            </svg>
          </button>
        </div>
      </div>
    </section>

    <style>
    .tariff-carousel-container {
        position: relative;
      width: 100%;
      overflow: visible;
      padding: 0 40px;
      margin-top: 50px;  /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
    }

    .tariff-carousel {
        display: flex;
      transition: transform 0.3s ease;
      gap: 20px;
      padding: 20px 0;  /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø—ã —Å–≤–µ—Ä—Ö—É –∏ —Å–Ω–∏–∑—É –¥–ª—è —Ö–æ–≤–µ—Ä–∞ */
    }

    .carousel-control {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: white;
      border: 1px solid #e0e0e0;
        display: flex;
        align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 10;
      transition: all 0.3s ease;
    }

    .carousel-control:hover {
      background: #f5f5f5;
      border-color: #731982;
    }

    .carousel-control.prev {
      left: 0;
    }

    .carousel-control.next {
      right: 0;
    }

    .carousel-control svg {
      width: 20px;
      height: 20px;
        color: #731982;
    }

    @media (max-width: 768px) {
      .tariff-carousel-container {
        padding: 0 30px;
      }
      
      .carousel-control {
        width: 32px;
        height: 32px;
      }
      
      .carousel-control svg {
        width: 16px;
        height: 16px;
      }
      }
    </style>

    <script>
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ç–∞—Ä–∏—Ñ–æ–≤
    function renderTariffs(tariffs) {
      const container = document.getElementById('tariffCardsContainer');
      
      if (tariffs.length === 0) {
        container.innerHTML = '<div class="col-12 text-center py-4">–¢–∞—Ä–∏—Ñ—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
        return;
      }

      let html = '';
      
      tariffs.forEach(tariff => {
        let tariffType = '';
        if (tariff.speed_mbps && tariff.minutes && tariff.tv_channels) {
          tariffType = 'internet-mobile-tv';
        } else if (tariff.speed_mbps && tariff.tv_channels) {
          tariffType = 'internet-tv';
        }

        html += `
          <div class="tariff-card-wrapper" data-tariff-type="${tariffType}">
            <div class="tariff-card ${tariff.name.includes('–ú–µ–≥–∞–¢–∞—Ä–∏—Ñ') ? 'megatariff' : ''}">
              <div class="tariff-header">
                <h3 class="tariff-name">${tariff.name}</h3>
                <div class="tariff-price-wrapper">
                  ${tariff.old_price ? `<span class="tariff-price-old">${tariff.old_price} ‚ÇΩ</span>` : ''}
                  <span class="tariff-price-current">${tariff.current_price} ‚ÇΩ</span>
                </div>
                <div class="tariff-duration">–∑–∞ ${tariff.duration_days} –¥–Ω–µ–π</div>
              </div>
              
              <div class="tariff-features">
                ${tariff.is_home_internet ? `
                  <div class="feature-row">
                    <div class="feature-icon">
                      <img src="../static/img/speed-icon.png" alt="–°–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞" width="24" height="24" style="object-fit: contain;">
                    </div>
                    <div class="feature-text">
                      –î–æ–º–∞—à–Ω–∏–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
                      ${tariff.home_internet_note ? `<span class="feature-promo">${tariff.home_internet_note}</span>` : ''}
                    </div>
                  </div>
                ` : ''}
                
                ${tariff.speed_mbps ? `
                  <div class="feature-row">
                    <div class="feature-icon">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M5 12.55a11 11 0 0 1 14.08 0"></path>
                        <path d="M1.42 9a16 16 0 0 1 21.16 0"></path>
                        <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                        <line x1="12" y1="20" x2="12" y2="20"></line>
                      </svg>
                    </div>
                    <div class="feature-text">${tariff.speed_mbps} –ú–±–∏—Ç/—Å</div>
                  </div>
                ` : ''}
                
                ${tariff.tv_channels ? `
                  <div class="feature-row">
                    <div class="feature-icon">
                      <svg width="24" height="24" viewBox="0 0 32 32" fill="none">
                        <path d="M11 11.91V20.08L12.32 21L21 17.22V14.64L12.25 11L11 11.91ZM13 13.49L19 15.93L13 18.47V13.49Z" fill="currentColor"/>
                        <path d="M24.74 7H19.59L20.89 4.39L19.11 3.5L17.36 7H14.64L12.89 3.5L11.1 4.39L12.41 7H7.26C6.39621 7.00264 5.56854 7.34695 4.95775 7.95775C4.34695 8.56854 4.00264 9.39621 4 10.26V21.74C4.00264 22.6038 4.34695 23.4315 4.95775 24.0423C5.56854 24.6531 6.39621 24.9974 7.26 25H24.75C25.1768 25 25.5994 24.9159 25.9937 24.7526C26.388 24.5893 26.7463 24.3499 27.0481 24.0481C27.3499 23.7463 27.5893 23.388 27.7526 22.9937C27.9159 22.5994 28 22.1768 28 21.75V10.26C27.9974 9.39621 27.6531 8.56854 27.0423 7.95775C26.4315 7.34695 25.6038 7.00264 24.74 7ZM26 21.75C26 22.0815 25.8683 22.3995 25.6339 22.6339C25.3995 22.8683 25.0815 23 24.75 23H7.26C6.92664 22.9974 6.60767 22.8638 6.37194 22.6281C6.1362 22.3923 6.00261 22.0734 6 21.74V10.26C6.00261 9.92664 6.1362 9.60767 6.37194 9.37193C6.60767 9.1362 6.92664 9.00261 7.26 9H24.74C25.0734 9.00261 25.3923 9.1362 25.6281 9.37193C25.8638 9.60767 25.9974 9.92664 26 10.26V21.75Z" fill="currentColor"/>
                      </svg>
                    </div>
                    <div class="feature-text">${tariff.tv_channels} –¢–í-–∫–∞–Ω–∞–ª–æ–≤</div>
                  </div>
                ` : ''}
                
                ${tariff.minutes ? `
                  <div class="feature-row">
                    <div class="feature-icon">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                      </svg>
                    </div>
                    <div class="feature-text">${tariff.minutes} –º–∏–Ω—É—Ç</div>
                  </div>
                ` : ''}
                
                ${tariff.gigabytes ? `
                  <div class="feature-row">
                    <div class="feature-icon">
                      <svg width="24" height="24" viewBox="0 0 32 32" fill="none">
                        <path d="M4 16.0001C4 22.6001 9.4 28.0001 16 28.0001C20.3 28.0001 24.2 25.7001 26.4 22.0001L24.7 21.0001C21.9 25.8001 15.8 27.4001 11 24.7001C6.2 22.0001 4.6 15.8001 7.3 11.0001C10 6.20009 16.2 4.60009 21 7.30009C22.5 8.20009 23.8 9.40009 24.7 11.0001L26.4 10.0001C23 4.30009 15.7 2.30009 10 5.70009C6.3 7.80009 4 11.7001 4 16.0001ZM28 17.0001H30V15.0001H28V13.0001H26V15.0001H24V17.0001H26V19.0001H28V17.0001ZM14 20.0001V19.0001H15V17.0001H14V15.0001H12V17.0001H10.4L12.1 11.6001L10.1 11.0001L8 17.8001L9 19.0001H12V20.0001H14ZM21.4 13.6001L22.6 12.0001C20.8 10.7001 18.2 10.8001 16.6 12.4001C14.8 14.2001 14.9 17.2001 16.8 18.9001C18.4 20.4001 20.8 20.6001 22.6 19.3001L23 19.0001V15.0001H20V17.0001H21V18.0001C20 18.5001 18.8 18.3001 18 17.5001C17 16.5001 17 14.9001 18 13.9001C18.9 12.9001 20.4 12.8001 21.4 13.6001Z" fill="currentColor"/>
                      </svg>
                    </div>
                    <div class="feature-text">${tariff.gigabytes} –ì–ë</div>
                  </div>
                ` : ''}
              </div>

              ${tariff.megasila_count ? `
                <div class="feature-row megasila-feature">
                  <div class="feature-icon purple">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                    </svg>
                  </div>
                  <div class="feature-text">${tariff.megasila_count} –ú–µ–≥–∞–°–∏–ª—ã –Ω–∞ –≤—ã–±–æ—Ä</div>
                </div>
              ` : ''}

              <div class="feature-row">
                <div class="feature-icon">
                  <svg width="24" height="24" viewBox="0 0 32 32" fill="none">
                    <path d="M16.4031 13.62C16.7174 13.9347 17.0979 14.1759 17.517 14.3261C17.9362 14.4764 18.3836 14.532 18.8269 14.489C19.2703 14.4459 19.6985 14.3053 20.0807 14.0772C20.4629 13.8491 20.7895 13.5392 21.037 13.17C21.3663 12.6751 21.5408 12.0939 21.5385 11.5C21.5385 10.7044 21.2215 9.94129 20.6572 9.37868C20.0929 8.81607 19.3275 8.5 18.5295 8.5C17.9328 8.50065 17.3497 8.67817 16.8544 9.01C16.3624 9.33868 15.9786 9.80481 15.7511 10.35C15.5232 10.8982 15.4635 11.5015 15.5795 12.0836C15.6956 12.6657 15.9822 13.2004 16.4031 13.62ZM25.9618 16.84C26.2745 17.1583 26.6767 17.3745 27.1153 17.46C27.5534 17.5427 28.0062 17.4975 28.4192 17.33C28.8276 17.1567 29.1762 16.8682 29.4222 16.5C29.6722 16.1309 29.805 15.6954 29.8034 15.25C29.8034 14.655 29.567 14.0842 29.1459 13.6625C28.7249 13.2409 28.1534 13.0026 27.5566 13C27.1099 12.9984 26.6731 13.1308 26.3029 13.38C25.9335 13.6253 25.6442 13.9729 25.4704 14.38C25.3023 14.7918 25.2571 15.2432 25.34 15.68C25.4238 16.1208 25.6408 16.5256 25.9618 16.84ZM10.1643 19.84C10.477 20.1583 10.8792 20.3745 11.3178 20.46C11.7559 20.5427 12.2087 20.4975 12.6217 20.33C13.03 20.1567 13.3787 19.8682 13.6247 19.5C13.9139 19.0672 14.0438 18.5479 13.9924 18.0304C13.9409 17.513 13.7112 17.0292 13.3424 16.6615C12.9736 16.2938 12.4884 16.0648 11.9693 16.0135C11.4503 15.9622 10.9294 16.0917 10.4953 16.38C10.126 16.6253 9.83663 16.9729 9.66281 17.38C9.49478 17.7918 9.4495 18.2432 9.53242 18.68C9.6214 19.1212 9.8416 19.5254 10.1643 19.84ZM22.4713 17.37C20.569 16.4268 18.4546 15.9893 16.3329 16.1H15.8815C15.8188 16.1022 15.7577 16.1197 15.7034 16.1511C15.6492 16.1825 15.6036 16.2268 15.5706 16.28C15.5407 16.3371 15.5251 16.4006 15.5251 16.465C15.5251 16.5294 15.5407 16.5929 15.5706 16.65C15.7574 17.2146 15.8523 17.8054 15.8514 18.4C15.8273 19.1418 15.7093 19.8776 15.5004 20.59C15.4558 20.699 15.4558 20.821 15.5004 20.93C15.5315 20.9774 15.5729 21.0173 15.6215 21.0467C15.6701 21.0761 15.7246 21.0943 15.7812 21.1C16.2145 21.2075 16.6078 21.4366 16.9146 21.76C17.2761 22.2975 17.4261 22.9491 17.3359 23.59C17.1754 25.41 16.8244 28.96 16.8244 28.96L17.3359 29.5H21.0972L22.8425 18.12C22.8619 17.9686 22.8338 17.8149 22.7622 17.68C22.7049 17.5458 22.6019 17.436 22.4713 17.37ZM15.2195 22.65C13.0031 21.7746 10.5352 21.7746 8.31877 22.65C8.20439 22.7058 8.11498 22.802 8.06801 22.92C8.00805 23.0371 7.98697 23.1702 8.00783 23.3L8.64976 31.5H14.8183L15.5104 23.34C15.5289 23.2111 15.5116 23.0797 15.4602 22.96C15.4185 22.8319 15.3334 22.7223 15.2195 22.65ZM30.676 20.17C30.6658 20.0777 30.635 19.9888 30.5857 19.91C30.543 19.8354 30.4849 19.7707 30.4152 19.72C29.5395 19.2508 28.5608 19.0053 27.5667 19.0053C26.5725 19.0053 25.5938 19.2508 24.7181 19.72C24.6401 19.7713 24.5749 19.8397 24.5275 19.92C24.4783 19.9988 24.4474 20.0877 24.4373 20.18L23.1534 30.8L23.7452 31.46H31.4082L32 30.79L30.676 20.17Z" fill="currentColor"/>
                  </svg>
                </div>
                <div class="feature-text">–î–æ–ø. –Ω–æ–º–µ—Ä–∞ –ø–æ 300 ‚ÇΩ</div>
              </div>
              
              <button class="connect-btn ${tariff.name.includes('–ú–µ–≥–∞–¢–∞—Ä–∏—Ñ') ? 'connect-btn-purple' : ''}" 
                data-tariff-id="${tariff.id}" data-tariff-name="${tariff.name}" data-tariff-price="${tariff.current_price}">
                –ü–æ–¥–∫–ª—é—á–∏—Ç—å
              </button>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
      document.querySelectorAll('.connect-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const tariffId = btn.getAttribute('data-tariff-id');
          const tariffName = btn.getAttribute('data-tariff-name');
          const tariffPrice = btn.getAttribute('data-tariff-price');
          showConnectModal(tariffId, tariffName, tariffPrice);
        });
      });

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—É—Å–µ–ª–∏
      initTariffCarousel();
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—É—Å–µ–ª–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
    function initTariffCarousel() {
      const carousel = document.querySelector('.tariff-carousel');
      const prevBtn = document.getElementById('prevTariff');
      const nextBtn = document.getElementById('nextTariff');
      const cardWidth = document.querySelector('.tariff-card-wrapper').offsetWidth;
      const gap = 20;
      let currentPosition = 0;
      const maxPosition = -(cardWidth + gap) * (document.querySelectorAll('.tariff-card-wrapper:not([style*="display: none"])').length - 4);

      function updateButtons() {
        prevBtn.style.opacity = currentPosition === 0 ? '0.5' : '1';
        nextBtn.style.opacity = currentPosition <= maxPosition ? '0.5' : '1';
      }

      prevBtn.addEventListener('click', () => {
        if (currentPosition < 0) {
          currentPosition += cardWidth + gap;
          carousel.style.transform = `translateX(${currentPosition}px)`;
          updateButtons();
        }
      });

      nextBtn.addEventListener('click', () => {
        const visibleCards = document.querySelectorAll('.tariff-card-wrapper:not([style*="display: none"])').length;
        const newMaxPosition = -(cardWidth + gap) * (visibleCards - 4);
        
        if (currentPosition > newMaxPosition) {
          currentPosition -= cardWidth + gap;
          carousel.style.transform = `translateX(${currentPosition}px)`;
          updateButtons();
        }
      });

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      updateButtons();
    }
    </script>
    

                <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –í–´–ë–û–†–ê –ì–û–†–û–î–ê -->
                <div class="city-modal hidden" id="cityModal">
                <div class="modal-content">
                    <div class="modal-header">
                    <h2>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –≥–æ—Ä–æ–¥</h2>
                    <span class="close-btn" onclick="closeCityModal()">&times;</span>
                    </div>

                    <div class="modal-search">
                    <form id="citySearchForm" onsubmit="event.preventDefault(); filterCities();">
                        <input type="text" placeholder="–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ" id="citySearch">
                        <button type="submit" class="search-icon">üîç</button>
                    </form>
                    </div>
                    
                    

                    <div class="modal-body">
                    <div class="regions-list" id="regionsList">
                        <!-- –†–µ–≥–∏–æ–Ω—ã –±—É–¥—É—Ç –ø–æ–¥–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ AJAX -->
                        <div class="region-placeholder">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤...</div>
                    </div>

                    <div class="cities-list" id="citiesColumn">
                        <div class="city-placeholder">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å —Å–ª–µ–≤–∞</div>
                    </div>
                    </div>
                </div>
                </div>

                <style>
                .city-modal {
                position: fixed;
                top: 0; left: 0;
                width: 100%; height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                }
                .modal-content {
                background: white;
                width: 80%;
                max-width: 1000px;
                border-radius: 8px;
                padding: 20px;
                max-height: 90vh;
                overflow: auto;
                }
                .modal-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
                }
                .modal-search {
                position: relative;
                margin-bottom: 20px;
                }
                .modal-search input {
                width: 100%;
                padding: 10px 40px 10px 10px;
                font-size: 16px;
                }
                .search-icon {
                position: absolute;
                right: 10px;
                top: 50%;
                transform: translateY(-50%);
                font-size: 18px;
                }
                .modal-body {
                display: flex;
                gap: 40px;
                }
                .regions-list, .cities-list {
                width: 50%;
                max-height: 400px;
                overflow-y: auto;
                }
                .region-letter {
                color: red;
                font-weight: bold;
                margin-top: 15px;
                }
                .region-item {
                cursor: pointer;
                padding: 4px 0;
                }
                .region-item:hover {
                text-decoration: underline;
                }
                .city-item {
                padding: 4px 0;
                }
                .city-placeholder {
                color: #888;
                font-style: italic;
                }
                .hidden {
                display: none !important;
                }
                </style>



    <!-- üîΩ –í–°–¢–ê–í–¨ –°–Æ–î–ê –°–ï–ö–¶–ò–Æ –ü–†–û–í–ï–†–ö–ò –ê–î–†–ï–°–ê -->
    <section class="address-check">
        <div class="container-custom">
        <div class="address-card">
            <div class="content">
            <h2>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à –∞–¥—Ä–µ—Å –Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å<br>–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ú–µ–≥–∞–§–æ–Ω</h2>
            <p class="subtitle">–ê –≤—Å—é –æ—Å—Ç–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–¥–µ–ª–∞–µ–º –º—ã</p>
    
            <div class="form-wrapper">
              <form class="address-form">
                <input type="text" placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º">
                <input type="tel" placeholder="+7 (___) ___-__-__">
                <button type="submit">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
              </form>
            
              <p class="note">–í–∞–∂–Ω–æ: —á–∞—Å—Ç–Ω—ã–µ –¥–æ–º–∞ –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ–º!</p>
            </div>
            
            </div>
    
            <img class="absolute-image" src="../static/img/puzzle.png" alt="–ü–∞–∑–ª—ã">
        </div>
        </div>
    </section>



    <section class="steps-section">
        <div class="container">
        <div class="steps-header">
            <h2 class="steps-title">–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç</h2>
            <div class="steps-list">
            <div class="step-card">
                <div class="step-number">1</div>
                <h3>–û—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É</h3>
                <p>–û—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å–∞–π—Ç–µ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º</p>
            </div>
            <div class="step-card">
                <div class="step-number">2</div>
                <h3>–ü—Ä–æ–≤–µ—Ä–∏–º –∞–¥—Ä–µ—Å</h3>
                <p>–ü—Ä–æ–≤–µ—Ä–∏–º –≤–∞—à –∞–¥—Ä–µ—Å –Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</p>
            </div>
            <div class="step-card">
                <div class="step-number">3</div>
                <h3>–ü–æ–¥–±–µ—Ä–µ–º —Ç–∞—Ä–∏—Ñ</h3>
                <p>–ü—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–µ–º –∏ –ø–æ–¥–±–µ—Ä–µ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω</p>
            </div>
            <div class="step-card">
                <div class="step-number active">4</div>
                <h3>–ü–æ–¥–∫–ª—é—á–∏–º</h3>
                <p>–ü—Ä–æ–∏–∑–≤–µ–¥–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ —É–¥–æ–±–Ω–æ–µ –¥–ª—è –≤–∞—Å –≤—Ä–µ–º—è</p>
            </div>
            </div>
        </div>
        </div>
    </section>

    
    
    <section class="faq-section py-5">
        <div class="container">
        <h2 class="faq-title mb-4">–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
        <div class="accordion custom-accordion" id="faqAccordion">
    
            <!-- –í–æ–ø—Ä–æ—Å 1 -->
            <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1" aria-expanded="true">
                –ö–∞–∫ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ú–µ–≥–∞–§–æ–Ω?
                </button>
            </h2>
            <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –≤—ã –º–æ–∂–µ—Ç–µ, –ø–æ–∑–≤–æ–Ω–∏–≤ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ <strong class="purple">8 (800) 250-93-87</strong> –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Å–∞–π—Ç–µ.
                </div>
            </div>
            </div>
    
            <!-- –í–æ–ø—Ä–æ—Å 2 -->
            <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                –ö–∞–∫ —É–∑–Ω–∞—Ç—å —Å–≤–æ–π –ª–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç?
                </button>
            </h2>
            <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚Äî —ç—Ç–æ –≤–∞—à –ª–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç. –° –µ–≥–æ –ø–æ–º–æ—â—å—é –º–æ–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å —É—Å–ª—É–≥–∏, –≤–æ–π—Ç–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∏ –≤ –ú–µ–≥–∞–§–æ–Ω –¢–í.
                </div>
            </div>
            </div>
    
            <!-- –í–æ–ø—Ä–æ—Å 3 -->
            <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å?
                </button>
            </h2>
            <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –º–æ–∂–Ω–æ –≤ –≥–æ–ª–æ—Å–æ–≤–æ–º –º–µ–Ω—é (–ø–æ–∑–≤–æ–Ω–∏–≤ –Ω–∞ <strong>0500</strong>), —Å –ø–æ–º–æ—â—å—é USSD –∫–æ–º–∞–Ω–¥—ã <code>*100#</code> –∏–ª–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.
                </div>
            </div>
            </div>
    
            <!-- –í–æ–ø—Ä–æ—Å 4 -->
            <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                –ö–∞–∫ –ø–æ–ø–æ–ª–Ω–∏—Ç—å —Å—á—ë—Ç?
                </button>
            </h2>
            <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                <ul>
                    <li>–í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç–æ–π, —Å–æ —Å—á—ë—Ç–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞, —Å –ø–æ–º–æ—â—å—é —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞.</li>
                    <li>–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –°–±–µ—Ä–±–∞–Ω–∫ –û–Ω–ª–∞–π–Ω ‚Äî —Ä–∞–∑–¥–µ–ª ¬´–ü–ª–∞—Ç–µ–∂–∏ –∏–ª–∏ –ø–µ—Ä–µ–≤–æ–¥—ã¬ª, —Ä–∞–∑–¥–µ–ª ¬´–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –¢–í¬ª, —É–∫–∞–∑–∞—Ç—å –ú–µ–≥–∞–§–æ–Ω, –≤–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä –ª–∏—Ü–µ–≤–æ–≥–æ —Å—á—ë—Ç–∞ –∏ —Å—É–º–º—É.</li>
                    <li>–í —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö Qiwi, CyberPlat, –≠–ª–µ–∫—Å–Ω–µ—Ç, –±–∞–Ω–∫–æ–º–∞—Ç–∞—Ö –∏ —Å–∞–ª–æ–Ω–∞—Ö —Å–≤—è–∑–∏: –ú–µ–≥–∞–§–æ–Ω –†–∏—Ç–µ–π–ª, –°–≤—è–∑–Ω–æ–π.</li>
                </ul>
                </div>
            </div>
            </div>
    
            <!-- –í–æ–ø—Ä–æ—Å 5 -->
            <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq5">
                –ö–∞–∫ –ø–µ—Ä–µ–π—Ç–∏ –≤ –ú–µ–≥–∞–§–æ–Ω —Å–æ —Å–≤–æ–∏–º –Ω–æ–º–µ—Ä–æ–º?
                </button>
            </h2>
            <div id="faq5" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                –í—ã –º–æ–∂–µ—Ç–µ, –ø–æ–∑–≤–æ–Ω–∏–≤ –ø–æ –Ω–æ–º–µ—Ä—É <strong class="purple">8 (800) 250-93-87</strong> –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Å–∞–π—Ç–µ.<br><br>
                <strong>–£—Å–ª–æ–≤–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –Ω–æ–º–µ—Ä–∞:</strong>
                <ul>
                    <li>–ù–∞ –ø–æ–¥–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –æ—Ñ–æ—Ä–º–ª–µ–Ω–æ –ª–∏–±–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–∞–≥–∞–µ—Ç—Å—è.</li>
                    <li>–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç–µ–∫—É—â–∏–º –¥–∞–Ω–Ω—ã–º.</li>
                    <li>–ù–µ—Ç –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏.</li>
                    <li>–ù–æ–º–µ—Ä –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –Ω–µ –≤ —Ä–æ–∑—ã—Å–∫–µ, –Ω–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π.</li>
                    <li>–° –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ –ø—Ä–æ—à–ª–æ –±–æ–ª–µ–µ 60 –¥–Ω–µ–π.</li>
                </ul>
                </div>
            </div>
            </div>
    
            <!-- –í–æ–ø—Ä–æ—Å 6 -->
            <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq6">
                –ö—É–¥–∞ –º–Ω–µ –æ–±—Ä–∞—â–∞—Ç—å—Å—è, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —É—Å–ª—É–≥–æ–π?
                </button>
            </h2>
            <div id="faq6" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –ø–æ –Ω–æ–º–µ—Ä—É <strong class="purple">8 (800) 250-93-87</strong>. –ú—ã –±—É–¥–µ–º —Ä–∞–¥—ã –≤–∞–º –ø–æ–º–æ—á—å!
                </div>
            </div>
            </div>
    
            <!-- –í–æ–ø—Ä–æ—Å 7 -->
            <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq7">
                –ö–∞–∫–æ–π —Ç–∞—Ä–∏—Ñ –ú–µ–≥–∞–§–æ–Ω —Å–∞–º—ã–π –≤—ã–≥–æ–¥–Ω—ã–π?
                </button>
            </h2>
            <div id="faq7" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                –ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç —Å–∞–º—ã–º–∏ –≤—ã–≥–æ–¥–Ω—ã–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –ú–µ–≥–∞–§–æ–Ω –ë–µ–∑–ü–µ—Ä–µ–ø–ª–∞—Ç –∏ –ú–µ–≥–∞–¢–∞—Ä–∏—Ñ. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ‚Äî –ø–æ –Ω–æ–º–µ—Ä—É <strong class="purple">8 (800) 250-93-87</strong> –∏–ª–∏ –Ω–∞ —Å–∞–π—Ç–µ.
                </div>
            </div>
            </div>
    
            <!-- –í–æ–ø—Ä–æ—Å 8 -->
            <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq8">
                –ö–∞–∫–æ–π —Ç–∞—Ä–∏—Ñ –¥–æ–º–∞—à–Ω–µ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤—ã–±—Ä–∞—Ç—å?
                </button>
            </h2>
            <div id="faq8" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–∞—Ä–∏—Ñ—ã –ú–µ–≥–∞–§–æ–Ω –∏ –µ–≥–æ —Ç–∞—Ä–∏—Ñ –ë–µ–∑–ü–µ—Ä–µ–ø–ª–∞—Ç –∏ –ú–µ–≥–∞–¢–∞—Ä–∏—Ñ, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –Ω–æ–º–µ—Ä—É <strong class="purple">8 (800) 250-93-87</strong> –∏–ª–∏ –Ω–∞ —Å–∞–π—Ç–µ.
                </div>
            </div>
            </div>
    
        </div>
        </div>
    </section>
    




        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>


        <script>
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ä–µ–≥–∏–æ–Ω–∞—Ö –∏ –≥–æ—Ä–æ–¥–∞—Ö
        let regionsAndCities = {};

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ –≥–æ—Ä–æ–¥–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞
        function loadRegionsAndCities() {
            fetch('/api/regions-towns/')
            .then(response => {
                if (!response.ok) {
                throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                regionsAndCities = data;
                renderRegionsList();
            })
            .catch(error => {
                console.error('Error fetching regions and cities:', error);
                document.getElementById('regionsList').innerHTML = '<div class="region-placeholder">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö</div>';
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤
        function renderRegionsList() {
            const regionsList = document.getElementById('regionsList');
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–≥–∏–æ–Ω—ã –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
            const sortedRegions = Object.keys(regionsAndCities).sort();
            
            let html = '';
            let currentLetter = '';
            
            sortedRegions.forEach(region => {
            // –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–≤—É—é –±—É–∫–≤—É —Ä–µ–≥–∏–æ–Ω–∞
            const firstLetter = region.charAt(0).toUpperCase();
            
            // –ï—Å–ª–∏ —ç—Ç–æ –Ω–æ–≤–∞—è –±—É–∫–≤–∞, –¥–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
            if (firstLetter !== currentLetter) {
                currentLetter = firstLetter;
                html += `<div class="region-letter">${currentLetter}</div>`;
            }
            
            html += `<div class="region-item" onclick="showCities('${region}')">${region}</div>`;
            });
            
            regionsList.innerHTML = html;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–æ—Ä–æ–¥–æ–≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞  
        function showCities(region) {
            const cities = regionsAndCities[region] || [];
            const container = document.getElementById('citiesColumn');
            container.innerHTML = cities.map(city => `<div class="city-item">${city}</div>`).join('');
        }
        
        function closeCityModal() {
            document.getElementById('cityModal').classList.add('hidden');
        }
        
        function filterCities() {
            const input = document.getElementById("citySearch").value.toLowerCase().trim();
            const container = document.getElementById('citiesColumn');
        
            if (!input) {
            container.innerHTML = '<div class="city-placeholder">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å —Å–ª–µ–≤–∞</div>';
            return;
            }
        
            const allCities = Object.entries(regionsAndCities).flatMap(([region, cities]) =>
            cities.map(city => ({
                region,
                city,
                cleanCity: city.replace(/^(–≥|–ø–≥—Ç|–ø|–¥|—Å|–∫)\s/, '').toLowerCase()
            }))
            );
        
            const filtered = allCities.filter(({ cleanCity }) => cleanCity.includes(input));
        
            container.innerHTML = filtered.length > 0
            ? filtered.map(({ city }) => `<div class="city-item">${city}</div>`).join('')
            : '<div class="city-placeholder">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
        }
        
        window.onload = function () {
            const regionBtn = document.querySelector('.region-button');
            const cityModal = document.getElementById('cityModal');
            const closeBtn = document.querySelector('.close-btn');
            const searchInput = document.getElementById("citySearch");
            const searchIcon = document.querySelector(".search-icon");

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–≥–∏–æ–Ω—ã –∏ –≥–æ—Ä–æ–¥–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            loadRegionsAndCities();

            regionBtn.addEventListener('click', () => {
            cityModal.classList.remove('hidden');
            });

            closeBtn.addEventListener('click', () => {
            cityModal.classList.add('hidden');
            });

            window.addEventListener('click', (e) => {
            if (e.target === cityModal) {
                cityModal.classList.add('hidden');
            }
            });

            searchInput.addEventListener("keydown", function (e) {
            if (e.key === "Enter") {
                e.preventDefault();
                filterCities();
            }
            });

            searchIcon.addEventListener("click", function (e) {
            e.preventDefault();
            filterCities();
            });
        };

        // –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ–±–Ω–æ–≤–ª—è–µ—Ç –æ–±–∞ –º–µ—Å—Ç–∞
        function updateSelectedCity(city) {
            document.getElementById('cityHeader').innerText = city;
            document.getElementById('cityTariff').innerText = city;
        }

        document.addEventListener('click', function (e) {
            if (e.target.classList.contains('city-item')) {
            const selectedCity = e.target.innerText;

            // –æ–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –≤ —à–∞–ø–∫–µ –∏ —Ç–∞—Ä–∏—Ñ–∞—Ö
            updateSelectedCity(selectedCity);
            closeCityModal();

            // —Å–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö –≥–æ—Ä–æ–¥–æ–≤
            document.querySelectorAll('.city-item').forEach(el => el.classList.remove('active'));

            // –¥–æ–±–∞–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–º—É
            e.target.classList.add('active');
            }
        });
        </script>

        <footer class="footer">
        <div class="container-footer">
            <div class="footer-col">
            <img src="../static/img/logo.svg" alt="–ú–µ–≥–∞–§–æ–Ω" class="footer-logo" />
            <div class="footer-partner">–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Ç–Ω—ë—Ä</div>
            <p class="footer-description">
                –ú–µ–≥–∞—Ñ–æ–Ω: —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: –¥–æ–º–∞—à–Ω–∏–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ, –ø–∞–∫–µ—Ç—ã —Å –º–æ–±–∏–ª—å–Ω–æ–π —Å–≤—è–∑—å—é, –∞ —Ç–∞–∫–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ª—É–≥ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞.
            </p>
            <small class="footer-copy">–°–∞–π—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ –ü–ê–û ¬´–ú–µ–≥–∞–§–æ–Ω¬ª. –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</small>
            </div>

            <div class="footer-col">
            <h4>–¢–∞—Ä–∏—Ñ—ã –Ω–∞ —É—Å–ª—É–≥–∏ –ú–µ–≥–∞—Ñ–æ–Ω</h4>
            <ul>
                <li><a href="#">–ú–µ–≥–∞—Ñ–æ–Ω –¥–æ–º–∞—à–Ω–∏–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç</a></li>
                <li><a href="#">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ</a></li>
                <li><a href="#">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç, –º–æ–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å –∏ –¢–í</a></li>
                <li><a href="#">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –º–æ–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å</a></li>
            </ul>
            </div>

            <div class="footer-col">
            <h4>–ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
            <ul>
                <li><a href="#">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –±–∏–∑–Ω–µ—Å–∞</a></li>
                <li><a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
            </ul>
            </div>
            
            <div class="footer-col">
            <h4>–û—Ç–¥–µ–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</h4>
            <div class="footer-button">
                <button class="call-btn">–ü–æ–∑–≤–æ–Ω–∏—Ç—å</button>
            </div>
            </div>
            
        </div>
        </footer>

      <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
      <div id="connectModal" class="modal hidden">
        <div class="modal-content">
          <span class="modal-close" id="closeModalBtn">&times;</span>
          <h2>–û—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</h2>
          <form id="connectionForm" novalidate>
            <input type="text" id="connectionName" name="name" placeholder="–ò–º—è" required>
            <input type="tel" id="connectionPhone" name="phone" placeholder="+7 (___) ___-__-__" required>
            <input type="text" id="connectionAddress" name="address" placeholder="–ê–¥—Ä–µ—Å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
            <input type="hidden" id="connectionTariffId" name="tariff_id">
            <button type="submit">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            <p class="note">–í–∞–∂–Ω–æ: —á–∞—Å—Ç–Ω—ã–µ –¥–æ–º–∞ –∏ –¥–∞—á–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ–º!</p>
          </form>
        </div>
      </div>

      <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É—Å–ø–µ—à–Ω–æ–π –∑–∞—è–≤–∫–∏ -->
      <div id="successModal" class="modal hidden">
        <div class="modal-content success-content">
          <h2>–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞</h2>
          <p>–ù–∞—à —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</p>
          <button id="closeSuccessBtn" class="success-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
      </div>

      <!-- –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω -->
      <style>
        .modal {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1050;
        }

        .modal-content {
          background-color: #fff;
          padding: 30px;
          border-radius: 16px;
          width: 90%;
          max-width: 500px;
          position: relative;
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .modal-close {
          position: absolute;
          top: 15px;
          right: 20px;
          font-size: 24px;
          cursor: pointer;
          color: #999;
        }

        .modal-content h2 {
          margin-top: 0;
          margin-bottom: 20px;
          font-size: 22px;
          color: #333;
        }

        .modal-content form {
          display: flex;
          flex-direction: column;
        }

        .modal-content input,
        .modal-content select {
          margin-bottom: 15px;
          padding: 12px 15px;
          border: 1px solid #ddd;
          border-radius: 8px;
          font-size: 16px;
        }

        .modal-content button {
          background-color: #00b956;
          color: white;
          border: none;
          border-radius: 30px;
          padding: 12px;
          font-size: 16px;
          font-weight: 600;
          cursor: pointer;
          margin-top: 10px;
        }

        .modal-content button:hover {
          background-color: #009a48;
        }

        .note {
          margin-top: 15px;
          font-size: 14px;
          color: #888;
          text-align: center;
        }

        .success-content {
          text-align: center;
          padding: 40px 30px;
        }

        .success-content h2 {
          color: #00b956;
          margin-bottom: 15px;
        }

        .success-content p {
          margin-bottom: 25px;
          font-size: 16px;
          color: #555;
        }

        .success-btn {
          background-color: #00b956;
          color: white;
          border: none;
          border-radius: 30px;
          padding: 12px 30px;
          font-size: 16px;
          font-weight: 600;
          cursor: pointer;
          display: inline-block;
        }

        .hidden {
          display: none !important;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ */
        .invalid-feedback {
          color: #dc3545;
          font-size: 14px;
          margin-top: -10px;
          margin-bottom: 10px;
        }

        input.is-invalid {
          border-color: #dc3545;
        }
      </style>

      <!-- JavaScript –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ä–º -->
      <script>

        // 1. –î–æ–±–∞–≤–∏–º —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
      function loadTariffs() {
        const container = document.getElementById('tariffCardsContainer');
        
        // –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –æ —Ç–∞—Ä–∏—Ñ–∞—Ö (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞)
        const sampleTariffs = [
          {
            id: 1,
            name: "–ú–µ–≥–∞–§–æ–Ω 3.0 –ú–µ–≥–∞–¢–∞—Ä–∏—Ñ",
            current_price: 950,
            old_price: 1050,
            duration_days: 30,
            is_home_internet: true,
            home_internet_note: "1 –º–µ—Å—è—Ü –∞–∫—Ü–∏—è",
            speed_mbps: 500,
            tv_channels: 250,
            minutes: 1000,
            gigabytes: 35,
            megasila_count: 4
          },
          {
            id: 2,
            name: "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç + –¢–í",
            current_price: 650,
            old_price: 800,
            duration_days: 30,
            is_home_internet: true,
            speed_mbps: 200,
            tv_channels: 160,
            minutes: 0,
            gigabytes: 0,
            megasila_count: 1
          },
          {
            id: 3,
            name: "–ú–µ–≥–∞–¢–∞—Ä–∏—Ñ –ú–∞–∫—Å–∏–º—É–º",
            current_price: 850,
            old_price: 1100,
            duration_days: 30,
            is_home_internet: true,
            speed_mbps: 300,
            tv_channels: 230,
            minutes: 1200,
            gigabytes: 50,
            megasila_count: 2
          },
          {
            id: 4,
            name: "–ì–∏–≥–∞–±–∏—Ç–Ω—ã–π –≠–∫—Å–ø—Ä–µ—Å—Å",
            current_price: 780,
            old_price: 1000,
            duration_days: 30,
            is_home_internet: true,
            speed_mbps: 1000,
            tv_channels: 0,
            minutes: 0,
            gigabytes: 0,
            megasila_count: 0
          }
        ];

        // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
        setTimeout(() => {
          renderTariffs(sampleTariffs);
        }, 500);
      }

      // 2. –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Ç–∞—Ä–∏—Ñ–æ–≤
      document.addEventListener('DOMContentLoaded', function() {
        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö/–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        const style = document.createElement('style');
        style.innerHTML = `
          .filter-btn {
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            padding: 8px 16px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
          }
          .filter-btn.active {
            background-color: #731982;
            color: white;
            border-color: #731982;
          }
        `;
        document.head.appendChild(style);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        const filterBtns = document.querySelectorAll('.filter-btn');
        filterBtns.forEach(btn => {
          btn.addEventListener('click', function() {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            filterBtns.forEach(b => b.classList.remove('active'));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –Ω–∞ –Ω–∞–∂–∞—Ç—É—é –∫–Ω–æ–ø–∫—É
            this.classList.add('active');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–∞—Ä–∏—Ñ—ã
            const filterType = this.getAttribute('data-filter');
            filterTariffs(filterType);
          });
        });

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–∞—Ä–∏—Ñ—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        loadTariffs();
      });

      // –§—É–Ω–∫—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
      function filterTariffs(filterType) {
        const cards = document.querySelectorAll('[data-tariff-type]');
        let visibleCards = 0;
        
        cards.forEach(card => {
          if (filterType === 'all' || card.getAttribute('data-tariff-type') === filterType) {
            card.style.display = 'block';
            visibleCards++;
          } else {
            card.style.display = 'none';
          }
        });

        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –∫–∞—Ä—É—Å–µ–ª–∏ –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
        resetCarousel();
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–æ–∑–∏—Ü–∏–∏ –∫–∞—Ä—É—Å–µ–ª–∏
      function resetCarousel() {
        const carousel = document.querySelector('.tariff-carousel');
        carousel.style.transform = 'translateX(0)';
        currentPosition = 0;
        updateButtons();
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—É—Å–µ–ª–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
      function initTariffCarousel() {
        const carousel = document.querySelector('.tariff-carousel');
        const prevBtn = document.getElementById('prevTariff');
        const nextBtn = document.getElementById('nextTariff');
        const cardWidth = document.querySelector('.tariff-card-wrapper').offsetWidth;
        const gap = 20;
        let currentPosition = 0;
        const maxPosition = -(cardWidth + gap) * (document.querySelectorAll('.tariff-card-wrapper:not([style*="display: none"])').length - 4);

        function updateButtons() {
          prevBtn.style.opacity = currentPosition === 0 ? '0.5' : '1';
          nextBtn.style.opacity = currentPosition <= maxPosition ? '0.5' : '1';
        }

        prevBtn.addEventListener('click', () => {
          if (currentPosition < 0) {
            currentPosition += cardWidth + gap;
            carousel.style.transform = `translateX(${currentPosition}px)`;
            updateButtons();
          }
        });

        nextBtn.addEventListener('click', () => {
          const visibleCards = document.querySelectorAll('.tariff-card-wrapper:not([style*="display: none"])').length;
          const newMaxPosition = -(cardWidth + gap) * (visibleCards - 4);
          
          if (currentPosition > newMaxPosition) {
            currentPosition -= cardWidth + gap;
            carousel.style.transform = `translateX(${currentPosition}px)`;
            updateButtons();
          }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        updateButtons();
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
      function showConnectModal(tariffId, tariffName, tariffPrice) {
        const modal = document.getElementById('connectModal');
        document.getElementById('connectionTariffId').value = tariffId;
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        if (tariffName && tariffPrice) {
          document.querySelector('#connectModal h2').textContent = 
            `–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: ${tariffName} –∑–∞ ${tariffPrice} ‚ÇΩ`;
        } else {
          document.querySelector('#connectModal h2').textContent = '–û—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ';
        }
        
        modal.classList.remove('hidden');
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ä–º—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
      function setupConnectionForm() {
        const form = document.getElementById('connectionForm');
        
        if (form) {
          form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
            const phoneInput = document.getElementById('connectionPhone');
            const nameInput = document.getElementById('connectionName');
            const tariffId = document.getElementById('connectionTariffId').value;
            const address = document.getElementById('connectionAddress').value;
            
            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
            document.querySelectorAll('.invalid-feedback').forEach(el => el.remove());
            document.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));
            
            let isValid = true;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏
            if (!nameInput.value.trim()) {
              showValidationError(nameInput, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è');
              isValid = false;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
            const phonePattern = /^\+?[0-9]{10,15}$/;
            const phoneValue = phoneInput.value.replace(/[^\d+]/g, '');
            
            if (!phoneValue || !phonePattern.test(phoneValue)) {
              showValidationError(phoneInput, '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
              isValid = false;
            }
            
            if (isValid) {
              // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
              const formData = {
                name: nameInput.value.trim(),
                phone_number: phoneValue,
                address: address.trim() || null,
                tariff: tariffId || null
              };
              
              // –ó–¥–µ—Å—å –±—É–¥–µ—Ç AJAX-–∑–∞–ø—Ä–æ—Å –∫ API
              fetch('/api/connection-requests/', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  'X-CSRFToken': getCsrfToken() // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è CSRF-—Ç–æ–∫–µ–Ω–∞ –∏–∑ cookies
                },
                body: JSON.stringify(formData)
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏');
                }
                return response.json();
              })
              .then(data => {
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
                document.getElementById('connectModal').classList.add('hidden');
                
                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                form.reset();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ —É—Å–ø–µ—Ö–∞
                document.getElementById('successModal').classList.remove('hidden');
              })
              .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
              });
            }
          });
        }
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
      function showValidationError(inputElement, message) {
        inputElement.classList.add('is-invalid');
        const errorDiv = document.createElement('div');
        errorDiv.className = 'invalid-feedback';
        errorDiv.textContent = message;
        inputElement.parentNode.insertBefore(errorDiv, inputElement.nextSibling);
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è CSRF-—Ç–æ–∫–µ–Ω–∞ –∏–∑ cookies
      function getCsrfToken() {
        const name = 'csrftoken';
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
        return '';
      }

      // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥—Ä–µ—Å–∞
      function setupAddressCheckForm() {
        const addressForm = document.querySelector('.address-form');
        
        if (addressForm) {
          addressForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const inputs = addressForm.querySelectorAll('input');
            const address = inputs[0].value.trim();
            const phone = inputs[1].value.replace(/[^\d+]/g, '');
            
            if (!address || !phone) {
              alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
              return;
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            const formData = {
              phone_number: phone,
              address: address
            };
            
            fetch('/api/address-check/', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCsrfToken()
              },
              body: JSON.stringify(formData)
            })
            .then(response => {
              if (!response.ok) {
                throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∞–¥—Ä–µ—Å–∞');
              }
              return response.json();
            })
            .then(data => {
              // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
              addressForm.reset();
              
              // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ —É—Å–ø–µ—Ö–∞
              document.getElementById('successModal').classList.remove('hidden');
            })
            .catch(error => {
              console.error('–û—à–∏–±–∫–∞:', error);
              alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∞–¥—Ä–µ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
            });
          });
        }
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ–æ—Ä–º –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
      document.addEventListener('DOMContentLoaded', function() {
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        const connectModal = document.getElementById('connectModal');
        const successModal = document.getElementById('successModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const closeSuccessBtn = document.getElementById('closeSuccessBtn');
        const headerConnectBtn = document.querySelector('.connect-btn');
        
        // –ö–Ω–æ–ø–∫–∞ –≤ —à–∞–ø–∫–µ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        if (headerConnectBtn) {
          headerConnectBtn.addEventListener('click', function(e) {
            e.preventDefault();
            showConnectModal();
          });
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        if (closeModalBtn) {
          closeModalBtn.addEventListener('click', function() {
            connectModal.classList.add('hidden');
          });
        }
        
        if (closeSuccessBtn) {
          closeSuccessBtn.addEventListener('click', function() {
            successModal.classList.add('hidden');
          });
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        window.addEventListener('click', function(e) {
          if (e.target === connectModal) {
            connectModal.classList.add('hidden');
          }
          if (e.target === successModal) {
            successModal.classList.add('hidden');
          }
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º
        setupConnectionForm();
        setupAddressCheckForm();
        
        // –ú–∞—Å–∫–∞ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–ø—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è)
        const phoneInputs = document.querySelectorAll('input[type="tel"]');
        phoneInputs.forEach(input => {
          input.addEventListener('input', function(e) {
            let value = this.value.replace(/\D/g, '');
            if (value.length > 0 && value[0] !== '7') {
              value = '7' + value;
            }
            let formattedValue = '';
            
            if (value.length > 0) {
              formattedValue = '+' + value.substring(0, 1);
            }
            if (value.length > 1) {
              formattedValue += ' (' + value.substring(1, 4);
            }
            if (value.length > 4) {
              formattedValue += ') ' + value.substring(4, 7);
            }
            if (value.length > 7) {
              formattedValue += '-' + value.substring(7, 9);
            }
            if (value.length > 9) {
              formattedValue += '-' + value.substring(9, 11);
            }
            
            this.value = formattedValue;
          });
        });
      });
      </script>

      <script>
        const burger = document.getElementById('burger-toggle');
        const menu = document.getElementById('mobileMenu');

        burger.addEventListener('click', () => {
          menu.classList.toggle('active');
        });
      </script>


    </body>
    </html>

{% endblock %}

